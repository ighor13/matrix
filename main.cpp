#include <stdio.h>
#include <iostream>
#include <iomanip>
#include "matrix.h"

using namespace std;

typedef long double elem;

const unsigned dimm=3;
const unsigned dimn=4;

void print(Matrix<elem> m, unsigned precision=7)
{
    for(unsigned i=0;i<m.m();i++)
    {
	for(unsigned j=0;j<m.n();j++)
	    cout<<setw(10)<<setprecision(precision)<<m.at(i,j);
	cout<<endl;
    }
}

int main(int argc, char* argv[])
{
    elem M[dimm][dimn]=
    {
	{6,		2,		-10,		4	},
	{-5,		-7,		-4,		1	},
	{2,		4,		-2,		-6	},
//	{3,		0,		-5,		4	},
    }
    ;

    elem iM[4][4]=
    {
	{6,		2,		-10,		4	},
	{-5,		-7,		-4,		1	},
	{2,		4,		-2,		-6	},
	{3,		0,		-5,		4	},
    }
    ;

    Matrix<elem> m1(dimm,dimn,(elem*)M);

    cout<<"-m1--------------------------------------------------------------------------------------"<<endl;
    print(m1);
    cout<<"----------------------------------------------------------------------------------------"<<endl;
    
    Matrix<elem> m2=m1.Transpose();

    cout<<"-m2--------------------------------------------------------------------------------------"<<endl;
    print(m2);
    cout<<"----------------------------------------------------------------------------------------"<<endl;

    Matrix<elem> p=m1*m2;
    

//    cout.setf(ios::scientific);
    
    cout<<"-p--------------------------------------------------------------------------------------"<<endl;
    print(p);
    cout<<"----------------------------------------------------------------------------------------"<<endl;

    Matrix<elem> s=p-((elem)2)*p;
    cout<<"-s--------------------------------------------------------------------------------------"<<endl;
    print(s);
    cout<<"----------------------------------------------------------------------------------------"<<endl;

    Matrix<elem> im(4,4,(elem*)iM);
    cout<<"-im--------------------------------------------------------------------------------------"<<endl;
    print(im);
    cout<<"----------------------------------------------------------------------------------------"<<endl;

    Matrix<elem> ir=im.Inverse();
    cout<<"-ir--------------------------------------------------------------------------------------"<<endl;
    print(ir);
    cout<<"----------------------------------------------------------------------------------------"<<endl;

    Matrix<elem> r=im*ir;
    cout<<"-r=ir*im--------------------------------------------------------------------------------"<<endl;
    print(r,2);
    cout<<"----------------------------------------------------------------------------------------"<<endl;

    try
    {
        cout<<"det(im)="<<setprecision(7)<<im.Determinant()<<endl;
    }
    catch(char* err)
    {
	cerr<<"Error: "<<err<<endl;
    }

    return 0;
}